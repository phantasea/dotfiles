" mapping {{{
map  <left>   <nop>
map  <right>  <nop>
map  <up>     <nop>
map  <down>   <nop>

nnoremap  <F5>   :shell<cr>
nnoremap  <F10>  :diff<cr>
nnoremap  <F11>  :diffsamewin<cr>

nnoremap  <return> <nop>
nnoremap  <bs>     gh
qnoremap  <space>  <tab>

cnoremap  <c-j>  <cr>
cnoremap  <c-l>  <c-x>
cnoremap  <c-o>  <s-tab>
cnoremap  <c-r>  <c-x>
cnoremap  <c-w>  <a-b><a-d>
nnoremap  <c-b>  :find . *<cr>b
nnoremap  <c-j>  <c-f>L
nnoremap  <c-k>  <c-b>H
qnoremap  <c-j>  <c-f>
qnoremap  <c-k>  <c-b>
qnoremap  <c-v>  <s-tab>
mnoremap  <c-j>  <c-f>
mnoremap  <c-k>  <c-b>
nnoremap  <c-v>  <s-tab>

"nnoremap <tab> :if isactive('preview') | swap | endif<cr>
nnoremap  0  gg
nnoremap  ^  gg
nnoremap  $  G
vnoremap  .  :!!<cr>
nnoremap  -  :invert s<cr>
vnoremap  -  :invert s<cr>
nnoremap  a  GVgg
vnoremap  a  ggoG
nnoremap  A  za
nnoremap  b  :set scrollbind!<cr>
nnoremap  cm cp
vnoremap  cm cp
nnoremap  cc :copen<cr>
nnoremap  cd :cd<space>
nnoremap  ci :copyfromother<cr>
vnoremap  ci :copyfromother<cr>
nnoremap  co :copytoother<cr>
vnoremap  co :copytoother<cr>
nnoremap  cI :sucopyfromother<cr>
vnoremap  cI :sucopyfromother<cr>
nnoremap  cO :sucopytoother<cr>
vnoremap  cO :sucopytoother<cr>
nnoremap  C  :clone<cr>
nnoremap  d  dd
nnoremap  D  DD
nnoremap ge  :empty<cr>
nnoremap  e  :edit %f<cr>
qnoremap  e  q:edit %c<cr>
nnoremap  E  :suedit<cr>
mnoremap  h  q
nnoremap gi  :imgall<cr>
nnoremap gI  :rimgall<cr>
nnoremap  i  :touch<space>
nnoremap  I  :mkdir! ""<left><c-x>c
nnoremap  J  <c-e>
mnoremap  J  <c-e>
nnoremap  K  <c-y>
mnoremap  K  <c-y>
qnoremap  J  qje:if isactive('preview') | switch | endif<cr>
qnoremap  K  qke:if isactive('preview') | switch | endif<cr>
nnoremap ml  :alink!<cr>
nnoremap gl  gf
nnoremap \l  :file &<cr>
nnoremap \o  :!sudo  %f<left><left><left>
nnoremap go  :! %f<left><left>
nnoremap  oo =
nnoremap  of zd
nnoremap  od zD
nnoremap  o. zA
nnoremap  O  zM
qnoremap  p  <c-b>
nnoremap  q  ZZ
nnoremap \r  :write | edit $MYVIFMRC | restart<cr>
nnoremap gr  :source ~/.vifm/vifmrc<cr>
nnoremap gr  :restart<cr>
vnoremap  r  cw
nnoremap  r  cw
nnoremap  R  :rename<cr>
qnoremap  s  <c-w>
nnoremap  s  <c-w>
nnoremap  sf :find . *<cr>b
nnoremap  sp :sync<cr>
"nnoremap ss :if layoutis('only') | vsplit | else | only | endif<cr>
"nnoremap ss :vsplit!<cr>
nnoremap  ss <c-w>S
nnoremap  st :tree<cr>
nnoremap \s  :sort<cr>
nnoremap  S  :%s//g<left><left>
vnoremap  S  :%s//g<left><left>
nnoremap \t  :lstrash<cr>
nnoremap gt  gs
nnoremap  t  tj
nnoremap  T  kt
nnoremap  U  <c-r>
qnoremap  v  q
nnoremap \v  :if layoutis('only') | vsplit | endif | view<cr>
"nnoremap v  :if !layoutis('only') | view | else | explore | endif<cr>
nnoremap  w  :set lsview!<cr>
nnoremap  W  :set nolaststatus!<cr>
nnoremap  xi :movefromother<cr>
vnoremap  xi :movefromother<cr>
nnoremap  xo :movetoother<cr>
vnoremap  xo :movetoother<cr>
nnoremap  xI :sumovefromother<cr>
vnoremap  xI :sumovefromother<cr>
nnoremap  xO :sumovetoother<cr>
vnoremap  xO :sumovetoother<cr>
nnoremap  y  yy
nnoremap  Y  :copyfilename<cr>
nnoremap gy  :copydirname<cr>
nnoremap  zv :if &vicmd == "vimux" | set vicmd="vim" | else | set vicmd="vimux" | endif<cr>

nnoremap  c<space> :if &viewcolumns == &hsviewcols 
                    \| set viewcolumns=-{name}...,{rating} | else 
                    \| set viewcolumns=-{name}...,{rating},17{mtime} | endif<cr>
" }}}

" cabbrev {{{
cabbrev  fn  <c-x>c
cabbrev  dn  <c-x>d
cabbrev  fno <c-x><c-x>c
cabbrev  dno <c-x><c-x>d
" }}}

" mark {{{
mark / /
mark h ~/
if $HOME == "/home/simone"
  mark H ~lynna/
else
  mark H ~simone/
endif
mark t ~/.Trash
mark m /media
mark n ~/docs/note
mark o /opt
mark P /opt/.porn
mark U /media/sandisk_u
mark V /media/sandisk_v
mark e /opt/.etc
mark g /opt/git
mark v /opt/.vim
mark u /opt/.util
mark w /opt/web
mark a /media/adb/storage/sdcard1

bmark! /home/lynna/doc doc
" }}}

" option {{{
" This is the actual command used to start vi.  The default is vim.
set vicmd="vimux"
set vixcmd="sublime-text &"

set tuioptions=""
set fillchars=vborder:|
set milleroptions=lsize:1,csize:2,rsize:1
set millerview

" Trash Directory
set trash
set trashdir="~/.Trash"

" This is how many directories to store in the directory history.
set history=16

" Follow links on l or Enter.
set nofollowlinks
set nochaselinks

" With this option turned on you can run partially entered commands with
" unambiguous beginning using :! (e.g. :!Te instead of :!Terminal or :!Te<tab>).
set nofastrun

" Natural sort of (version) numbers within text.
set sortnumbers
set sort="+iname"

" Maximum number of changes that can be undone.
set undolevels=16

" If you installed the vim.txt help file set vimhelp.
" If would rather use a plain text help file set novimhelp.
set novimhelp

" If you would like to run an executable file when you
" press return on the file name set this.
set norunexec

" Use KiB, MiB, ... instead of KB, MB, ...
set noiec

" Display suggestions in normal, visual and view modes for keys, marks and
" registers (at most 5 files).  In other view, when available.
"set suggestoptions=normal,visual,view,otherpane,keys,marks,registers
set suggestoptions=normal,visual,view

" Selected color scheme
colorscheme chris

" The FUSE_HOME directory will be used as a root dir for all FUSE mounts.
" Unless it exists with write/exec permissions set, vifm will attempt to create it.
set fusehome=/tmp/vifm_FUSE

" Don't do too many requests to slow file systems
if !has('win')
  set slowfs=curlftpfs
endif

" See man date or man strftime for details.
set timefmt=%H:%M\ %m/%d/%y
set rulerformat="%=%l%%%S [+%0-]"
set statusline="[%A] %u∶%g%d 【%a】 %r %=%s 〓\"%t%T\"%D"

set viewcolumns=-{name},{rating},17{mtime}

" *****************************
set sizefmt=units:iec,precision:1
set numberwidth=1
set tabstop=4
set confirm=permdelete
set dirsize=nitems
set shortmess="T"
set timeoutlen=2000
set notitle
set nolsview
set prefervsplit
set laststatus
set classify=":dir:"
set cpoptions="s"
set caseoptions="pg"
set dotdirs=rootparent
set grepprg=ag\ --line-numbers\ %i\ %a\ %s
windo filter! /lost\+found/
" *****************************

" Show list of matches on tab complition in command-line mode
set wildmenu
set wildstyle=popup

" Ignore case in search patterns unless it contains at least one uppercase letter
set ignorecase
set smartcase

" Highlight search, search while typing
set hlsearch
set incsearch
set wrapscan

" Try to leave some space from cursor to upper/lower border in lists
set scrolloff=0
" }}}

" command {{{
" :com[mand] command_name action
" The following macros can be used in a command
" %a is replaced with the user arguments.
" %c the current file under the cursor.
" %C the current file under the cursor in the other directory.
" %f the current selected file, or files.
" %F the current selected file, or files in the other directory.
" %b same as %f %F.
" %d the current directory name.
" %D the other window directory name.
" %i completely ignore command output
" %m run the command in a menu window
" %S Show command output in the status bar
command! sued  !sudoedit %c
command! surm  sudo rm -rf %c
command! rc    vimux ~/.vifm/vifmrc
command! df    df -h %m 2> /dev/null
command! ps    pstree %m
command! du    ncdu . 
command! diff  vim -d %c %C
command! diffsamewin  vimdiff %f
command! uz    tar -zxf %c %i &
command! uj    tar -jxf %c %i &
command! zip   zip -r %f.zip %f
command! run   !! ./%f
command! make  !!make
command! mkcd  :mkdir %a | cd %a
command! md    mkdir -p %a
command! mv    mv -r %f %D
command! cp    cp -r %f %D
command! movetoother     mv -i %f %D %i &
command! copytoother     cp -R %f %D %i &
command! movefromother   mv -i %F %d %i &
command! copyfromother   cp -R %F %d %i &
command! sumovetoother   sudo mv -i %f %D %i
command! sucopytoother   sudo cp -R %f %D %i
command! sumovefromother sudo mv -i %F %d %i
command! sucopyfromother sudo cp -R %F %d %i
command! copyfilename    tmux setb %f %i &
command! copydirname     tmux setb %d %i &
command! iconv   iconv -f GBK -t UTF8 %c -o %c.new %i
command! reload  :write | restart
command! vid     vidmu    x %c
command! vidfs   vidmux -f %c
command! vgrep   vim "+grep %a"
command! fim     fim %f > /dev/null 2>&1
command! imgall  imgview -s
command! rimgall imgview -rs
" }}}

" filetype and fileview {{{
" The file type is for the default programs to be used with a file extension.
" :filetype pattern1,pattern2 defaultprogram,program2
" :fileviewer pattern1,pattern2 consoleviewer
" The other programs for the file type can be accessed with the :file command
" The command macros %f, %F, %d, %F may be used in the commands.
" The %a macro is ignored.  To use a % you must put %%.

" For automated FUSE mounts, you must register an extension with :file[x]type
" in one of following formats:
"
" :filetype extensions FUSE_MOUNT|some_mount_command using %SOURCE_FILE and %DESTINATION_DIR variables
" %SOURCE_FILE and %DESTINATION_DIR are filled in by vifm at runtime.
" A sample line might look like this:
" :filetype *.zip,*.jar,*.war,*.ear FUSE_MOUNT|fuse-zip %SOURCE_FILE %DESTINATION_DIR
"
" :filetype extensions FUSE_MOUNT2|some_mount_command using %PARAM and %DESTINATION_DIR variables
" %PARAM and %DESTINATION_DIR are filled in by vifm at runtime.
" A sample line might look like this:
" :filetype *.ssh FUSE_MOUNT2|sshfs %PARAM %DESTINATION_DIR
" %PARAM value is filled from the first line of file (whole line).
" Example first line for SshMount filetype: root@127.0.0.1:/
"
" You can also add %CLEAR if you want to clear screen before running FUSE program.

" You can use filename modifiers after %c, %C, %f, %F, %b, %d and %D macros.  Supported modifiers are:
" :p - full path
" :~ - relative to the home directory
" :. - relative to current directory
" :h - head of the filename
" :t - tail of the filename
" :r - root of the filename (without last extension)

" Manpage
filetype  *.[1-8] man ./%c
fileview  *.[1-8] man ./%c | col -b

" Office files
fileview  *.doc  antiword %f, catdoc %f
fileview  *.docx docx2txt.pl %f -
if $DISPLAY == ""
  filetype  *.doc  vim %f
else
  filextype *.doc,*.docx,*.xls,*.xlsx,*.ppt,*.pptx  libreoffice %c &
endif

" c/c++ files
fileview  *.h,*.c,*.cpp  highlight -S c -O ansi -s dante %f

" xml files
fileview  *.xml  highlight -S xml -O ansi -s dante %f

" makefile
fileview  Makefile*,makefile*  highlight -S make -O ansi -s dante %f

" python files
fileview  *.py  highlight -S python -O ansi -s dante %f

" shell script
fileview  *.sh  highlight -S sh -O ansi -s dante %f

" Directories
fileview  */,.*/  tree -F --dirsfirst %c

" Pdf
fileview  *.pdf pdftotext -l 1 -nopgbrk -q %c -
if $DISPLAY == ""
  filetype  *.pdf fimgs %f
else
  filextype *.pdf zathura %c %i, apvlv %c
endif

" PostScript
fileview  *.ps ps2text %f -
if $DISPLAY == ""
  filetype  *.ps fimgs %f
else
  filextype *.ps,*.ps.gz zathura %f
endif

" Djvu
if $DISPLAY != ""
  filextype *.djvu zathura %f, apvlv %f
endif

" PGP
fileview  *.asc  gpg --quiet --no-tty --no-use-agent --no-verbose -d %f
filetype  *.asc  !!gpg --verify %c

" Audio
fileview  *.mp3,*.wav,*.flac,*.ogg,*.m4a  mediainfo -c %f
filetype  *.mp3,*.wav,*.flac,*.ogg,*.m4a  mpg123 -q %c > /dev/null 2>&1 &

" Video
fileview  *.avi,*.mp4,*.wmv,*.3gp,*.ogv,*.mkv,*.mpg,*.vob,*.flv,*.rmvb,*.rmb,*.vdat  mediainfo -f %c
filetype  *.avi,*.mp4,*.wmv,*.3gp,*.ogv,*.mkv,*.mpg,*.vob,*.flv,*.rmvb,*.rmb,*.vdat  vidmux %c

" Image
"fileview *.bmp,*.jpg,*.jpeg,*.png,*.gif,*.xpm,*.ppm  mediainfo -f %f
fileview  *.bmp,*.jpg,*.jpeg,*.png,*.gif,*.xpm,*.ppm  w3mimg %px %py %pw %ph %c
filetype  *.bmp,*.jpg,*.jpeg,*.png,*.gif,*.xpm,*.ppm  imgview %c

" Web
fileview  *.html,*.htm,*.xhtml,*.shtml  w3m -dump -cols 128 -T text/html %f
if $DISPLAY == ""
  filetype  *.html,*.htm,*.xhtml,*.shtml  wemux %f
else
  filextype *.html,*.htm,*.xhtml,*.shtml  firefox %f &
endif

" Markdown
fileview  *.md,*.mkd,*.markdown  pandoc -f markdown -t html %f |w3m -dump -cols 128 -T text/html

" Log
fileview  *.log  tac %c, tail -n500 %c
filetype  *.log  tac %c | less

" Object
fileview  *.o nm %f
filetype  *.o nm %f | less

" torrent
fileview  *.torrent  transmission-show %c

" FuseZipMount
fileview  *.zip,*.jar,*.war,*.ear  als %c
filetype  *.zip,*.jar,*.war,*.ear
       \ {Mount with fuse-zip}
       \ FUSE_MOUNT|fuse-zip %SOURCE_FILE %DESTINATION_DIR,
       \ {View contents}
       \ zip -sf %c | less,
       \ tar -xf %c,

" ArchiveMount
fileview  *.tar,*.tgz,*.tar.gz,*.tbz,*.tbz2,*.tar.bz2  als %c
filetype  *.tar,*.tgz,*.tar.gz,*.tbz,*.tbz2,*.tar.bz2
       \ {Mount with archivemount}
       \ FUSE_MOUNT|archivemount %SOURCE_FILE %DESTINATION_DIR,

" Fuse7z
fileview  *.7z  als %c, 7z | %c
filetype  *.7z
       \ {Mount with fuse-7z}
       \ FUSE_MOUNT|fuse-7z %SOURCE_FILE %DESTINATION_DIR,

" Rar2FsMount
fileview  *.rar  als %c, unrar v %c
filetype  *.rar
       \ {Mount with rar2fs}
       \ FUSE_MOUNT|rar2fs %SOURCE_FILE %DESTINATION_DIR,

" IsoMount
fileview  *.iso  isoinfo -l -i %c
filetype  *.iso
       \ {Mount with fuseiso}
       \ FUSE_MOUNT|fuseiso %SOURCE_FILE %DESTINATION_DIR,

" SshMount
filetype  *.ssh
       \ {Mount with sshfs}
       \ FUSE_MOUNT2|sshfs %PARAM %DESTINATION_DIR,

" FtpMount
filetype  *.ftp
       \ {Mount with curlftpfs}
       \ FUSE_MOUNT2|curlftpfs -o ftp_port=-,,disable_eprt %PARAM %DESTINATION_DIR,

" OpenRaster
filextype *.ora
        \ {Edit in MyPaint}
        \ mypaint %f,

" Mindmap
filextype *.vym
        \ {Open with VYM}
        \ vym %f &,

" MD5
filetype *.md5
       \ {Check MD5 hash sum}
       \ md5sum -c %f %S,

" SHA1
filetype *.sha1
       \ {Check SHA1 hash sum}
       \ sha1sum -c %f %S,

" SHA256
filetype *.sha256
       \ {Check SHA256 hash sum}
       \ sha256sum -c %f %S,

" SHA512
filetype *.sha512
       \ {Check SHA512 hash sum}
       \ sha512sum -c %f %S,

" Misc
fileview  *.a,*.deb,*.alz,*.xz,*.txz,*.tZ,*.tzo*.xpi  als %c

" Open all other files with default system programs. By default all unknown files are opened with 'vi[x]cmd'
"fileview * mediainfo %f
"fileview * pygmentize -f console -g -- %c
if $DISPLAY == ""
  filetype  * vimux %f
else
  filextype * sublime-text %f
endif
" }}}

" What should be saved automatically between vifm runs
set vifminfo=chistory,dhistory,fhistory,shistory,savedirs,state,tui,dirstack,ratings

