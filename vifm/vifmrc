" keymaps-1 {{{
map  <left>   <nop>
map  <right>  <nop>
map  <up>     <nop>
map  <down>   <nop>

"[n]ormal, [v]isual, [d]ialogue, [q]uickview, [m]enu, [c]ommand"
nnoremap  <F1>     :manhelp<cr>
nnoremap  <F5>     :shell<cr>
nnoremap  <F10>    :diff<cr>
nnoremap  <F11>    :diffsamewin<cr>
nnoremap  <F12>    :!cmatrix -abs -C cyan<cr>

"<tab> = <c-i>
"cycle thru the layouts -- only, vsplit, split
nnoremap  <s-tab>  :if layoutis('only')
                  \|    vsplit
                  \|elseif layoutis('vsplit')
                  \|    split
                  \|else
                  \|    only
                  \|endif<cr>
qnoremap  <s-tab>  <tab>

nnoremap b<tab>    <nop>
nnoremap c<tab>    <nop>
nnoremap f<tab>    <nop>
nnoremap g<tab>    <nop>
nnoremap m<tab>    <nop>
nnoremap o<tab>    :!tmux split "watch tsp"<cr>
nnoremap s<tab>    <nop>
nnoremap x<tab>    <nop>
nnoremap z<tab>    <nop>

" <cr> = <c-m>
vnoremap  <cr>     :select<cr>
nnoremap  <cr>     :togglesort<cr>
nnoremap b<cr>     :bmgo<space>
nnoremap c<cr>     <nop>
nnoremap f<cr>     <nop>
nnoremap g<cr>     <nop>
nnoremap m<cr>     <nop>
nnoremap o<cr>     <nop>
nnoremap s<cr>     :shell<cr>
nnoremap x<cr>     <nop>
nnoremap z<cr>     :!dotify %f<cr>

nnoremap  <bs>     <c-h>
mnoremap  <bs>     <c-b>
qnoremap  <space>  <tab>
mnoremap  <space>  <c-f>
nnoremap  <space>  :keepsel switch<cr>
nnoremap b<space>  :if toggle("bold") | hi Win cterm=bold | else | hi Win cterm=none | endif<cr>
nnoremap c<space>  :if &laststatus | colorscheme lynna | else | colorscheme chris | endif<cr>
nnoremap f<space>  :if &sort == '+iname' | set sort='-mtime,+iname' | exec 'normal gg' | else | set sort='+iname' | endif<cr>
nnoremap g<space>  :edit $MYVIFMRC<cr>
nnoremap m<space>  <nop>
nnoremap o<space>  :if toggle("bold") | hi OddLine cterm=bold | else | hi OddLine cterm=none | endif<cr>
nnoremap s<space>  :if &sort == '+iname' | set sort='-size,+iname' | exec 'normal gg' | else | set sort='+iname' | endif<cr>
nnoremap x<space>  <c-w>x
nnoremap z<space>  :invert o<cr>

"navigation mode
anoremap  <c-j>  <pagedown>
anoremap  <c-k>  <pageup>
anoremap  <c-h>  <c-o>
anoremap  <c-l>  <cr>
anoremap  <c-g>  <home>

"<c-@> means Ctrl+Space to switch to cmdline navigation mode
cnoremap  <c-@>  <c-y>
cnoremap  <c-g>  <a-f>
cnoremap  <c-j>  <cr>
cnoremap  <c-o>  <s-tab>
cnoremap  <c-r>  <c-x>
cnoremap  <c-t>  <c-g>
cnoremap  <c-v>  <c-x>s
cnoremap  <c-y>  <a-b>

nnoremap  <c-a>  :ffauds<cr>
nnoremap  <c-b>  :tree!<cr>
nnoremap  <c-c>  :history<cr>
vnoremap  <c-c>  :history<cr>
nnoremap  <c-d>  :ffdirs<cr>
nnoremap  <c-e>  :ffedit<cr>
nnoremap  <c-f>  :fffave<cr>
nnoremap  <c-g>  :ffgoto<cr>
mnoremap  <c-j>  <c-f>
nnoremap  <c-j>  <c-f>
qnoremap  <c-j>  <c-f>
vnoremap  <c-j>  <c-f>
mnoremap  <c-k>  <c-b>
nnoremap  <c-k>  <c-b>
qnoremap  <c-k>  <c-b>
vnoremap  <c-k>  <c-b>
nnoremap  <c-n>  gt
vnoremap  <c-n>  gt
qnoremap  <c-n>  a
nnoremap  <c-p>  gT
vnoremap  <c-p>  gT
qnoremap  <c-p>  A
nnoremap  <c-q>  :tabonly<cr>
nnoremap  <c-r>  :restore<cr>
nnoremap  <c-s>  :tabnew<cr>
vnoremap  <c-s>  :tabnew<cr>
nnoremap  <c-t>  :tabnew ~<cr>
vnoremap  <c-t>  :tabnew ~<cr>
nnoremap  <c-u>  U
nnoremap  <c-v>  :ffvids<cr>
nnoremap  <c-w>  :ffwebs<cr>
nnoremap  <c-x>  :fftext<cr>
nnoremap  <c-y>  :ffpics<cr>
nnoremap  <c-z>  :ffiptv /opt/conf/iptv/<tab><tab>

nnoremap  <a-j>  <space>j<space>
nnoremap  <a-k>  <space>k<space>

nnoremap  +ar  :chmod a+r<cr>
nnoremap  +aw  :chmod a+w<cr>
nnoremap  +ax  :chmod a+x<cr>
nnoremap  +ur  :chmod u+r<cr>
nnoremap  +uw  :chmod u+w<cr>
nnoremap  +ux  :chmod u+x<cr>
nnoremap  +gr  :chmod g+r<cr>
nnoremap  +gw  :chmod g+w<cr>
nnoremap  +gx  :chmod g+x<cr>
nnoremap  +or  :chmod o+r<cr>
nnoremap  +ow  :chmod o+w<cr>
nnoremap  +ox  :chmod o+x<cr>
nnoremap  -ar  :chmod a-r<cr>
nnoremap  -aw  :chmod a-w<cr>
nnoremap  -ax  :chmod a-x<cr>
nnoremap  -ur  :chmod u-r<cr>
nnoremap  -uw  :chmod u-w<cr>
nnoremap  -ux  :chmod u-x<cr>
nnoremap  -gr  :chmod g-r<cr>
nnoremap  -gw  :chmod g-w<cr>
nnoremap  -gx  :chmod g-x<cr>
nnoremap  -or  :chmod o-r<cr>
nnoremap  -ow  :chmod o-w<cr>
nnoremap  -ox  :chmod o-x<cr>

vnoremap  +ar  :chmod a+r<cr>
vnoremap  +aw  :chmod a+w<cr>
vnoremap  +ax  :chmod a+x<cr>
vnoremap  +ur  :chmod u+r<cr>
vnoremap  +uw  :chmod u+w<cr>
vnoremap  +ux  :chmod u+x<cr>
vnoremap  +gr  :chmod g+r<cr>
vnoremap  +gw  :chmod g+w<cr>
vnoremap  +gx  :chmod g+x<cr>
vnoremap  +or  :chmod o+r<cr>
vnoremap  +ow  :chmod o+w<cr>
vnoremap  +ox  :chmod o+x<cr>
vnoremap  -ar  :chmod a-r<cr>
vnoremap  -aw  :chmod a-w<cr>
vnoremap  -ax  :chmod a-x<cr>
vnoremap  -ur  :chmod u-r<cr>
vnoremap  -uw  :chmod u-w<cr>
vnoremap  -ux  :chmod u-x<cr>
vnoremap  -gr  :chmod g-r<cr>
vnoremap  -gw  :chmod g-w<cr>
vnoremap  -gx  :chmod g-x<cr>
vnoremap  -or  :chmod o-r<cr>
vnoremap  -ow  :chmod o-w<cr>
vnoremap  -ox  :chmod o-x<cr>

"nnoremap <c-h> :if paneisat('left')   | execute '!tmux select-pane -L %i' | else | execute 'wincmd h' | endif<cr>
"nnoremap <c-j> :if paneisat('bottom') | execute '!tmux select-pane -D %i' | else | execute 'wincmd j' | endif<cr>
"nnoremap <c-k> :if paneisat('top')    | execute '!tmux select-pane -U %i' | else | execute 'wincmd k' | endif<cr>
"nnoremap <c-l> :if paneisat('right')  | execute '!tmux select-pane -R %i' | else | execute 'wincmd l' | endif<cr>

" mount ISO filesystem images(iso,bin,img): list, mount, unmount
" nnoremap bl  :!ls -1 /tmp/fuseiso<cr>
" nnoremap bm  :!mkdir -p /tmp/fuseiso && fuseiso -n -p %f "/tmp/fuseiso/%f"<cr>
" nnoremap bu  :!fusermount -u %f<cr>
" }}}

" keymaps-2 {{{
nnoremap  0  gg
nnoremap  ^  gg
nnoremap  $  G
nnoremap  @  :shell<cr>
nnoremap  !  !!  %c<left><left><left>
nnoremap g!  :!./%c:. &<cr>
nnoremap  &  !!  %c &<left><left><left><left><left>
nnoremap  ~  :cd ~<cr>
nnoremap  -  :cd -<cr>
nnoremap g.  hgfl:set nodotfiles<cr>
nnoremap  +  <nop>
nnoremap  ?  :file<space><tab>
nnoremap g#  :windo set relativenumber!<cr>
nnoremap  #  :togglelinenumber<cr>
nnoremap g*  #
nnoremap  \  :invert s<cr>
vnoremap  \  :invert s<cr>
nnoremap  <  <c-w>h<c-w><
nnoremap  >  <c-w>h<c-w>>
nnoremap  |  <c-w>=
nnoremap  a  GVgg
nnoremap  a  :%select<cr>
vnoremap  a  ggoG
qnoremap  a  <nop>
qnoremap  A  <nop>
nnoremap  A  za
nnoremap ga  gA
nnoremap  bb :bmarks<cr>
nnoremap  bc :command<cr>
nnoremap  bC :change<cr>
nnoremap  bf :file<cr>
nnoremap  bg :bmgo<space>
nnoremap  bj :jobs<cr>
nnoremap  bk :nmap<cr>
nnoremap  bl :messages<cr>
nnoremap  bm :marks<cr>
nnoremap  bM :media<cr>
nnoremap  br :ratings<cr>
nnoremap  bs :sort<cr>
nnoremap  bt :lstrash<cr>
nnoremap  bu :undolist<cr>
nnoremap  bo :copen<cr>
nnoremap  c. cw<c-a><c-d><cr>
nnoremap  cc :change<cr>
nnoremap  cd :cd<space>
nnoremap  cs :colorscheme<space><tab>
nnoremap  cS :cds/
nnoremap  cg :goto<space>
nnoremap  cm :chmod<space>
vnoremap  cm :chmod<space>
nnoremap  cM cp
vnoremap  cM cp
nnoremap  cl cl
nnoremap  ct :!touch -m -t  %f<left><left><left>
nnoremap  cv av
vnoremap  cv <cr>
nnoremap  ci :copyfromother<cr>
vnoremap  ci :copyfromother<cr>
nnoremap  co :copytoother<cr>
vnoremap  co :copytoother<cr>
nnoremap  cI :sucopyfromother<cr>
vnoremap  cI :sucopyfromother<cr>
nnoremap  cO :sucopytoother<cr>
vnoremap  cO :sucopytoother<cr>
nnoremap gc  :edit ./.git/config<cr>
nnoremap  d  dd
nnoremap  D  DD
nnoremap  e  :edit %c<cr>
mnoremap  e  v
qnoremap  e  v
nnoremap  E  :!vim %c<cr>
nnoremap ge  :empty<cr>
mnoremap  h  q
dnoremap  h  q
nnoremap  i  :touch<space>
qnoremap  i  <nop>
nnoremap gi  :imgall<cr>
nnoremap ,i  :!fzfimg<cr>
nnoremap ,I  :mkdir! ""<left>
nnoremap  I  :mkdir! ""<left><c-x>c
nnoremap gI  :imgrall<cr>
nnoremap gj  ]R
nnoremap sj  <space>j<space>
nnoremap zj  }
nnoremap  J  <c-e>
mnoremap  J  <c-e>
qnoremap  J  qje:if &preview | switch | endif<cr>
nnoremap gk  [R
nnoremap zk  {
nnoremap sk  <space>k<space>
nnoremap  K  <c-y>
mnoremap  K  <c-y>
qnoremap  K  qke:if isactive('preview') | switch | endif<cr>
"nnoremap l  i
nnoremap gl  :if filetype('.') != 'link' && filetype('.') != 'dir' | altopen | else | exec 'normal gf' | endif<cr>
nnoremap gL  :if filetype('.') == 'exe' | exec 'normal i' | else | auxopen | endif<cr>
nnoremap  mi :medinfo<cr>
nnoremap  mI :tsls<cr>
nnoremap  mj 2gM
nnoremap  mm gMzz
nnoremap  mk 3gM
nnoremap gm  gMzz
nnoremap  oo =
nnoremap  of zF
nnoremap  od zD
nnoremap  ol zL
nnoremap  or zS
nnoremap  os :invert s<cr>zf
nnoremap  ot :exec "filter /\.".expand('%c:e')."$/i"<cr>
nnoremap  o. zA
nnoremap  O  zO
qnoremap  p  <c-b>
nnoremap  q  ZZ
vnoremap  q  ZZ
nnoremap  Q  :qall<cr>
nnoremap gq  q
nnoremap gr  :grep<space>
mnoremap gr  :grep<space>
vnoremap  r  cw
nnoremap  r  cW
nnoremap  R  cw
nnoremap ,r  cW<c-u>
qnoremap  s  <c-w>
nnoremap  s  <c-w>
nnoremap  sa :exec "select /\.".expand('%c:e')."$/i"<cr>
nnoremap  sb :set scrollbind!<cr>
nnoremap  sc :! cat %f > %c.txt<cr>gs
vnoremap  sc :! cat %f > %c.txt<cr>gv
nnoremap  sC :selcat<space>
vnoremap  sC :selcat<space>
nnoremap  sd :if selfiles() != 2 | diff | else | diffsamewin | endif<cr>
vnoremap  sd :if selfiles() != 2 | diff | else | diffsamewin | endif<cr>
nnoremap  sD :compare bycontents listall ofboth<cr>
nnoremap  se :suedit<cr>
nnoremap  sf :find<space>
nnoremap  si :switch<cr>:sync<cr>:switch<cr>
nnoremap  sl :alink<cr>
nnoremap  sL :alink!<cr>
nnoremap  so :sync<cr>
nnoremap  sp al
nnoremap  sq :hideui<cr>
nnoremap  sr :source $VIFM/vifmrc<cr>
nnoremap  sR :suremove<cr>
nnoremap  ss <c-w>S
qnoremap  ss <c-w>S
nnoremap  st :if getpanetype() == regular | tree | else | exec 'norm gh' | endif<cr>
nnoremap  sv :if &previewprg == '' | set previewprg='git log --color -- %c 2>&1' | view! | else | view! | endif<cr>
nnoremap  sw :!setwallpaper %c %i<cr>
nnoremap  sx <c-w>x:switch<cr>
nnoremap gS  :%s//g<left><left>
nnoremap  S  :s//g<left><left>
vnoremap  S  :s//g<left><left>
nnoremap gs  :select //i<left><left>
nnoremap ,s  :! ls -p | grep -v / | sort -t' ' -k2 %m<cr>
nnoremap gt  gs
nnoremap  t  tj
nnoremap  T  kt
nnoremap  U  <c-r>
qnoremap  v  q
nnoremap bv  :if &viewcolumns == '-{name}'
           \| setdefaultviewcolumns
           \| set milleroptions=lsize:2,csize:5,rsize:3,rpreview:dirs
           \| imgclear
           \| else | set viewcolumns=-{name}
           \| set milleroptions=lsize:2,csize:3,rsize:5,rpreview:all | endif<cr>
nnoremap gv  gv
nnoremap ov  :explore<cr>
nnoremap zv  :explore<cr>
qnoremap  w  W
nnoremap  w  :set millerview!<cr>
nnoremap  W  :if &millerview | set nomillerview | set lsview | else | set millerview | set nolsview | endif<cr>
nnoremap  xi :movefromother<cr>
vnoremap  xi :movefromother<cr>
nnoremap  xo :movetoother<cr>
vnoremap  xo :movetoother<cr>
nnoremap  xI :sumovefromother<cr>
vnoremap  xI :sumovefromother<cr>
nnoremap  xO :sumovetoother<cr>
vnoremap  xO :sumovetoother<cr>
nnoremap  y  yy
nnoremap  Y  :yankbasename<cr>
nnoremap gy  :yankrootname<cr>
nnoremap gY  :yankpathname<cr>
nnoremap cy  :cyankbasename<cr>
nnoremap cY  :cyankpathname<cr>
nnoremap xy  :xyankbasename<cr>
nnoremap xY  :xyankpathname<cr>:echo expand('%"d') "is yanked"<cr>
nnoremap  ze :if filetype('.') == 'dir' | exec 'normal }k' | else | exec 'normal {j' | endif<cr>
" }}}

" abbrevs {{{
cabbrev  mf   <c-x>m
cabbrev  fn   <c-x>c
cabbrev  dn   <c-x>d
cabbrev  fno  <c-x><c-x>c
cabbrev  dno  <c-x><c-x>d
cabbrev  cs   colorscheme
" }}}

" marks/bmarks/mpc {{{
source $VIFM/bookmarks
"source $VIFM/vifm-mpc
" }}}

" options {{{
source $VIFM/devicons

set vicmd="vimux"
set vixcmd="vimux"

plugin whitelist viewcolumn

if executable('vim')
set vimabs="vim"
elseif executable('nvim')
set vimabs="nvim"
endif

set vifminfo=tui,tabs,savedirs,ratings,shistory
set sessionoptions=tui,tabs,savedirs,ratings
set iooptions=fastfilecloning
set cpoptions="s"
set tuioptions="uv"
set caseoptions="pg"
set previewoptions=graphicsdelay:30000,maxtreedepth:3,toptreestats
set milleroptions=lsize:2,csize:5,rsize:3,rpreview:dirs
set suggestoptions=normal,visual,keys,delay:1000

set aproposprg='apropos %a'
set deleteprg=""
set findprg='fd -i -d=3 -t=f %p %s'
set grepprg='rg --smart-case --vimgrep %i %a'
set locateprg='locate %a'
set mediaprg='vifmmed'
set previewprg=""

set syscalls
set notitle
set nolsview
set lsoptions=transposed,columncount:0
set nodotfiles
set millerview
set tabstop=4
set number
set relativenumber
set numberwidth=1
set shortmess="pT"
set timeoutlen=2000
set confirm=permdelete
set dotdirs=treeleafsparent
set tabscope=pane
set showtabline=multiple
set tabprefix="[%0*%N:"
set tablabel="%0*%[(%n)%]%[%[%T{tree}%]%[{%c}%]@%]%p%0*"
set tabsuffix="]"
set statusline="%1*[%A]%7*|%5*%u:%g%7*|%2*%d%7*|%[%6*%r%7*|%]%4* %= \"%T\""
set rulerformat="%[f='%F'%] %= %E/%a  %l/%S%[(+%x)%]%[%H%]  --%P--"
set fillchars="vborder:|,hborder:,millersep:"
set dirsize=nitems
if $DISPLAY != ""
set timefmt="%H:%M\ %m/%d/%y"
set viewcolumns=-{name},{rating},17{mtime}
else
set timefmt="%Y-%m-%d %H:%M:%S"
set viewcolumns=-{name},{rating},22{mtime}
endif
set sizefmt=units:iec,precision:1,nospace
set wildmenu
set wildstyle=popup
set ignorecase
set smartcase
set hlsearch
set hloptions=filehi:allrows
set incsearch
set wrapscan
set scrolloff=0
set trash
set trashdir="~/.Trash"
set history=18
set nofollowlinks
set nochaselinks
set sortnumbers
set sort="+iname"
set undolevels=9
set vimhelp
set norunexec
set noiec
set fusehome=/tmp/vifm_FUSE
if !has('win')
set slowfs=curlftpfs
endif

"add by sim1---------------
set redolastcmdcfm
set prefervsplit
set maxundotabs=3
set previewmaxsize=3000
set nofilenamedispall
set topmidfiller="+"
set nocdaftermkdir

if $DISPLAY == ""
set paneonetag=" ㈠"
set panetwotag=" ㈡"
set filenamedisplen=52
set clipboardprg="tmux show-buffer"
else
set paneonetag=" ①"
set panetwotag=" ②"
set filenamedisplen=47
set clipboardprg="xsel -ob"
endif
"add by sim1---------------

"if $TERM == 'screen-256color' || $TERM == 'st-256color' || $TERM == 'xterm-256color'
if $DISPLAY != ""
colorscheme alice
else
colorscheme chris
endif

windo filter! /(lost\+found|Desktop|\.pyo$|\.pyc$|__pycache__|Volume|RECYCLE|snap|sogoupinyin|华为手机助手)/
" }}}

" commands {{{
" :com[mand][!] command_name action
" These are some of the macros that can be used in a command:
"  %a for user arguments
"  %c for current file under the cursor
"  %C for current file under the cursor of inactive pane
"  %f for selected file(s)
"  %F for selected file(s) of inactive pane
"  %b is the same as %f %F
"  %d for current directory name
"  %D for current directory name of inactive pane
"  %i completely ignore command output
"  %r{x} for list of files in register {x}
"  %m runs the command in a menu window
"  %S Show command output in the status bar
"  see `:help vifm-macros` and `:help vifm-filename-modifiers` for more
command! selcat          cat %f > %a
command! diff            vimux -d %c %C
command! diffsamewin     vimux -d %f
command! diffallsels     vimux -b
command! movetoother     mv -i %f %D %i
command! copytoother     cp -R %f %D %i
command! movefromother   mv -i %F %d %i
command! copyfromother   cp -R %F %d %i
command! sumovetoother   sudo mv -i %f %D
command! sucopytoother   sudo cp -R %f %D
command! sumovefromother sudo mv -i %F %d
command! sucopyfromother sudo cp -R %F %d
command! suedit          sudoedit %c
command! suremove        sudo rm -i %f
command! suchgown        sudo chown simone:simone %f
command! suchgmod        sudo chmod 400 %f
command! copyrsync       tsp rsync -a %f %D
command! moversync       tsp rsync -a --remove-source-files %f %D &&
                        \tsp find %f -type d -empty -exec rmdir {} \; && tsp rmdir %f
command! cyankbasename   tmux setb "%f" %i
command! cyankpathname   tmux setb %d %i
command! cyankfullname   tmux setb %d/%c %i
command! cyankrootname   echo -n %c | rev | cut -d\. -f2- | rev | tr -d '\n' | xargs -0 tmux setb %i
if executable('xclip')
command! xyankbasename   echo -n %f   | xclip -i -sel p -f | xclip -i -sel c %i
command! xyankrootname   printf '%%s' %c | sed "s/\.[^.]*$//" | xclip -sel c %i
command! xyankpathname   echo -n %d   | xclip -i -sel p -f | xclip -i -sel c %i
command! xyankfullname   echo -n %c:p | xclip -i -sel p -f | xclip -i -sel c %i
elseif executable('xsel')
command! xyankbasename   echo -n %f   | tee >(xsel -i -p) >(xsel -i -b) %i
command! xyankrootname   printf '%%s' %c | sed "s/\.[^.]*$//" | xsel -i -p %i
command! xyankpathname   echo -n %d   | tee >(xsel -i -p) >(xsel -i -b) %i
command! xyankfullname   echo -n %c:p | tee >(xsel -i -p) >(xsel -i -b) %i
endif
if $DISPLAY == ""
command!  yankbasename   tmux setb "%f" %i
command!  yankrootname   echo -n %c | rev | cut -d\. -f2- | rev | tr -d '\n' | xargs -0 tmux setb %i
command!  yankpathname   echo -n %d   | xargs -0 tmux setb %i
command!  yankfullname   tmux setb %d/%c %i
else
command!  yankbasename   echo -n %f   | xclip -i -sel p -f | xclip -i -sel c %i
command!  yankrootname   echo -n %c | rev | cut -d\. -f2- | rev | tr -d '\n' | xsel -i; xsel -o | xsel -b %i
command!  yankpathname   echo -n %d   | xclip -i -sel p -f | xclip -i -sel c %i
command!  yankfullname   echo -n %c:p | xclip -i -sel p -f | xclip -i -sel c %i
endif

command! togglelinenumber
      \ :if &number == 0 && &relativenumber == 0
      \ |    set relativenumber
      \ |elseif &number == 0 && &relativenumber == 1
      \ |    set number
      \ |else
      \ |    set nonumber
      \ |    set norelativenumber
      \ |endif

command! togglesort
      \ :if &sort == '+iname'
      \ |    set sort=-mtime
      \ |    echo 'sorted by -mtime'
      \ |elseif &sort == '-mtime,+name'
      \ |    set sort=-size
      \ |    echo 'sorted by -size'
      \ |else
      \ |    set sort=+iname
      \ |    echo 'sorted by +iname'
      \ |endif

command! setdefaultviewcolumns
      \ :if $DISPLAY != ""
      \ |    set viewcolumns=-{name},{rating},17{mtime}
      \ |else
      \ |    set viewcolumns=-{name},{rating},22{mtime}
      \ |endif

command! sxivA    sxiv -roqt * %u
command! fimA     fim * %u
command! sxivB    :select! !sxiv -oqt *
command! fimB     :select! !fim *

command! imgclear vifmimg clear
command! clock    tty-clock -cBS -C 6
command! cmatrix  cmatrix -abs -C cyan
command! editrc   vimux $VIFM/vifmrc
command! df       df -h %m 2>/dev/null
command! ps       pstree %m
command! ctags    ctags -R . %i
command! du       ncdu .
command! uz       tar -zxf %c %i
command! uj       tar -jxf %c %i
command! zip      zip -r %f.zip %f
command! zx       zx %f
command! extractA aunpack -e %f &>/dev/null &
command! extractB tsp atool -x %f
command! extractC tsp atool -e -X %D %f
command! extractD tsp atool -e -X %D/%f %f
command! extractE tsp atool -D -e -X %D %f
command! archiveA apack %a %f &>/dev/null &
command! archiveB set -- %f; tsp apack "$(echo "$1" | sed 's/\.[^.]*$//').zip" "$@"
command! archiveC set -- %f; tsp apack "$(echo "$1" | sed 's/\.[^.]*$//').7z" "$@"
command! run      !! ./%f
command! make     !!make %a
command! mkcd     :mkdir %a | cd %a
command! md       mkdir -p %a
command! mv       mv -r %f %D
command! cp       cp -r %f %D
command! link     ln -s %d/%f %D
command! mkbt     mktorrent -p -a -o %D/%f.torrent %d%f
command! reload   :write | restart full
command! iconv    iconv -f GBK -t UTF8 %c -o %c %i
command! vgrep    vim "+grep %a"
command! mpv      mpv --vo=drm %c
command! mpl      mplayer -vo x11 %c
command! fim      fim %f > /dev/null 2>&1
command! imgall   imgview -s
command! imgrall  imgview -rs
command! medinfo  medinfo %c %S
command! tsls     medinfo -t %m
command! manhelp  manmux vifm
command! weather  curl --silent wttr.in | sed 's/\x1B\[[0-9;]*[mGK]//g' | less
command! weather  curl --silent wttr.in | bat
command! altopen  fileopen -b %c
command! auxopen  fileopen -B %c
command! ffgotoA  :set noquickview | :exec 'goto' fnameescape(term('locate $HOME | fzf --height=0 2>/dev/tty'))
command! ffgotoB  :set noquickview | :exec 'goto' fnameescape(term('fd -t=f -t=l | fzf --height=0 2>/dev/tty'))
command! ffgotoC  :exec 'goto' fnameescape(system('locate -i %a | fzf 2>/dev/tty')) '%IU' | redraw
command! ffgotoD  :exec 'goto' fnameescape(system('fd -t=f -t=l | fzf 2>/dev/tty')) '%IU' | redraw
command! ffgoto   fd -L --type file | fzf --height=0 --print0 | xargs -0r vifmgoto
command! ffdirs   fd -L --type directory | fzf --height=0 --print0 | xargs -0r vifmgoto
command! ffedit   fd -d=3 -t=f -t=l -H -E .git --size=-800k | fzf --height=0 -1 -q "%a" --bind 'ctrl-o:execute(fzfopen {})' | xargs -r vifmedit
command! fffave   cat ~/.favedirs | sed "s#\~#$HOME#" | xargs fd -a -t=f -t=l . | fzf --height=0 --bind 'ctrl-o:execute(fzfopen {})' | xargs -r vifmedit
command! ffauds   fd -H -L -d=3 -t=f -e=mp3 -e=m4a . /opt/.porn/asmr | fzf --height=0 --bind 'ctrl-o:execute-silent(fzfopen {})' | sed 's/ /\\ /g' | xargs -r audplay
command! ffvids   fd -H -L -d=3 -t=f -e=mp4 -e=webm -e=avi -e=mkv -e=rmvb . ~/vids | fzf --height=0 --bind 'ctrl-o:execute(fzfopen {})' | sed 's/ /\\ /g' | xargs -r vidplay
command! ffwebs   fd -d=1 -t=f . ~/docs/webs | fzf --height=0 --bind 'ctrl-o:execute(fzfopen {})' | sed 's/ /\\ /g' | xargs -r webview
command! fftext   fd -d=2 -t=f -e=html -e=epub -e=pdf -e=txt . /opt/.porn/text | fzf --height=0 --bind 'ctrl-o:execute(fzfopen {})' | sed 's/ /\\ /g' | xargs -r webview
command! ffauds   fd -H -L -d=3 -t=f -e=mp3 -e=m4a . /opt/.porn/asmr | fzf --height=0 | xargs -r vifmgoto
command! ffvids   fd -H -L -d=3 -t=f -e=mp4 -e=webm -e=avi -e=mkv -e=rmvb . ~/vids | fzf --height=0 | xargs -r vifmgoto
command! ffwebs   fd -d=1 -t=f . ~/docs/webs | fzf --height=0 --print0 | xargs -0r vifmgoto
command! fftext   fd -d=2 -t=f -e=html -e=epub -e=pdf -e=txt . /opt/.porn/text | fzf --height=0 --print0 | xargs -0r vifmgoto
command! ffpics   fd -L -E '{*.webp,*.jpg,*.jpeg,*.JPG,*.JPEG}' . /opt/.porn/pics | fzf --height=0 --print0 | xargs -0 -r vifmgoto
command! ffiptv   cat %a | fzf -d, --with-nth -1 --height=0 | xargs -r vidplay -x 2>/dev/null
command! fftest   :let $FZF_RES = term("fd -d 2 -t d '' ".expand('%d')." | fzf-tmux --height 10 2> /dev/tty")
                  \| if $FZF_RES != ''
                  \|   exec 'cd' fnameescape($FZF_RES)
                  \| endif
" }}}

" autocmds {{{
autocmd DirEnter '/opt/util'          setl nomillerview lsview previewprg='bat --style="plain" -- %c'
autocmd DirEnter '/opt/apps/vifm'     exec 'normal fs;'
autocmd DirEnter '~/docs/misc'        exec 'normal zF'
autocmd DirEnter '~/docs/webs'        exec 'normal zF'
autocmd DirEnter '~/misc/gits/**/*'   setl dotfiles
autocmd DirEnter '~/pics/celeb/*/'    setl sort='-mtime,+iname'
autocmd DirEnter '~/pics/combo'       setl sort='-mtime,+iname'
autocmd DirEnter '~/pics/fave*'       setl sort='-mtime,+iname'
autocmd DirEnter '~/pics/geohist'     setl sort='-mtime,+iname'
autocmd DirEnter '~/pics/gifs'        setl sort='-mtime,+iname'
autocmd DirEnter '~/pics/misc'        setl sort='-mtime,+iname'
autocmd DirEnter '~/pics/preg'        setl sort='-mtime,+iname'
autocmd DirEnter '~/pics/wallpaper'   setl sort='-mtime,+iname'
autocmd DirEnter '/media/simone/*_z'  setl sort='-mtime,+iname'
" }}}

" filetype/fileview {{{
" The file type is for the default programs to be used with a file extension.
" :filetype pattern1,pattern2 defaultprogram,program2
" :fileviewer pattern1,pattern2 consoleviewer
" The other programs for the file type can be accessed with the :file command
" The command macros like %f, %F, %d, %D may be used in the commands.
" The %a macro is ignored.  To use a % you must put %%.

" For automated FUSE mounts, you must register an extension with :file[x]type
" in one of following formats:
"
" :filetype extensions FUSE_MOUNT|some_mount_command using %SOURCE_FILE and %DESTINATION_DIR variables
" %SOURCE_FILE and %DESTINATION_DIR are filled in by vifm at runtime.
" A sample line might look like this:
" :filetype *.zip,*.jar,*.war,*.ear FUSE_MOUNT|fuse-zip %SOURCE_FILE %DESTINATION_DIR
"
" :filetype extensions FUSE_MOUNT2|some_mount_command using %PARAM and %DESTINATION_DIR variables
" %PARAM and %DESTINATION_DIR are filled in by vifm at runtime.
" A sample line might look like this:
" :filetype *.ssh FUSE_MOUNT2|sshfs %PARAM %DESTINATION_DIR
" %PARAM value is filled from the first line of file (whole line).
" Example first line for SshMount filetype: root@127.0.0.1:/
"
" You can also add %CLEAR if you want to clear screen before running FUSE program.

" You can use filename modifiers after %c, %C, %f, %F, %b, %d and %D macros.  Supported modifiers are:
" :p - full path
" :~ - relative to the home directory
" :. - relative to current directory
" :h - head of the filename
" :t - tail of the filename
" :r - root of the filename (without last extension)

" Directories
fileview  */,.*/  tree -L 2 -C --dirsfirst %c

" Manpage
filetype  *.[1-8],*.[1-8].gz  man ./%c
fileview  *.[1-8],*.[1-8].gz  man ./%c | col -b

" Office files
filextype *.doc,*.docx,*.xls,*.xlsx,*.ppt,*.pptx  libreoffice %c &
filetype  .xls,*.xlsx,*.csv,*.tsv  vd %c, sc-im %c
fileview  *.doc  antiword %c, catdoc -- %c
fileview  *.docx docx2txt %c -, catdoc -- %c, pandoc -s -t markdown -- %c
fileview  *.ppt  catppt %c
fileview  *.csv  mlr --icsv --opprint cat %c,
               \ sed "s/,,,,/,,-,,/g;s/,,/ /g" %c | column -t | sed "s/ - /  /g" | cut -c -%pw
fileview  *.xls  xls2csv -- %c, catdoc -- %c
fileview  *.xlsx xlsx2csv -- %c, catdoc -- %c
fileview  *.odt,*.doc,*.docx  unoconv -f text --stdout %c
fileview  *.ods,*.xls,*.xlsx  unoconv -f csv  --stdout %c

" tpp files
filetype  *.tpp  tpp %c

" c/c++ files
fileview  *.h,*.c,*.cpp  highlight -S c -O ansi -s dante %c, bat --color=always %c

" xml files
fileview  *.xml  highlight -S xml -O ansi -s dante %c, bat --color=always %c

" makefile
fileview  Makefile*,makefile*  highlight -S make -O ansi -s dante %c, bat --color=always %c

" python files
fileview  *.py  highlight -S python -O ansi -s dante %c, bat --color=always %c

" shell script
fileview  *.sh  highlight -S sh -O ansi -s dante %c, bat --color=always %c

" Audio
filetype  {*.mp3,*.wav,*.ogg,*.m4a,*.aac,*.wma,*.ape,*.rm},<audio/*>
          \ medinfo %c %S,
          \ audplay %c &,
          \ audplay -b %c &,
          \ audplay -B %c &,
fileview  <audio/*>
          \ exiftool %c,
          \ mediainfo %c,
          \ ffprobe -pretty %c 2>&1,

" Video
filetype  {*.avi,*.mp4,*.wmv,*.mkv,*.mpg,*.mov,*.flv,*.rmvb,*.rmb,*.vdat,*.webm},<video/*>
          \ vidplay %c &,
          \ totem 2>/dev/null %c &,
          \ ffplay -v quiet %c &,
          \ mediainfo %f %m 2>&1,
fileview  <video/*>
          \ exiftool %c,
          \ mediainfo %c,
          \ ffprobe -pretty %c 2>&1,
          \ thumbnail %px %py %pw %ph %c,

" Image
filetype  {*.bmp,*.jpg,*.jpeg,*.png,*.xpm,*.ppm,*.webp},<image/*>
          \ imgview %c,
          \ imgview -b %c,
          \ imgview -B %c,
filextype *.svg  vimiv %f
filextype *.bmp,*.jpg,*.jpeg,*.png,*.xpm,*.ppm,*.webp
          \ pho -p %c, pho -p -s1 %c,
          \ feh -F %c, feh -F -D 1 %c,
          \ vimiv %f %i, vimiv --slideshow,
          \ sxiv -ft %f, sxiv -fS 1 %f,
          \ pqiv -fs, pqiv -f --action="montage_mode_enter()" --thumbnail-size=128x128,
if $DISPLAY != ""
fileview  <image/*>,<font/*>
          \ vifmimg draw %px %py %pw %ph %c %pc vifmimg clear,
          " viu works in Kitty with truecolor, or fallbacks to ansi256 mode
          \ viu %c,
endif
fileview  <image/*>
          \ w3mimg %px %py %pw %ph %c,
          \ exiftool %c, mediainfo %c, imgcat %c,
          \ chafa --clear -c 256 --bg blue %c,

" PDF
filetype  *.pdf  pdfview %c %i, pdfview -b %c %i, pdfview -B %c %i
fileview  *.pdf
          \ pdftotext -l 3 -nopgbrk -q -- %c -,
          \ thumbnail %px %py %pw %ph %c,
          \ mutool draw -F txt -i -- %c,

" PostScript
fileview  *.ps  ps2text %c -
if $DISPLAY == ""
filetype  *.ps  fimgs %c
else
filetype  *.ps,*.ps.gz  zathura %c %i
endif

" Djvu
fileview  *.djvu  djvutxt %c, exiftool %c
filextype *.djvu  zathura %c %i, apvlv %c
filetype  *.djvu  fbpdf %c

" epub
filetype  *.epub  epubview %c %i, epubview -b %c %i
fileview  *.epub  pandoc %c -t plain, epy -d %c

" chm
filextype *.chm  kchmviewer %c %i

" Webpage
filetype  *.html,*.htm,*.xhtml,*.shtml  webview %c, webview -b %c, webview -B %c, webview -bB %c
fileview  *.html,*.htm,*.xhtml,*.shtml
          \ w3m -dump -cols %pw -T text/html %c,
          \ elinks -dump -dump-width %pw %c,
          \ pandoc -s -t markdown -- %c,

" Markdown
fileview  *.md,*.mkd,*.markdown  pandoc -f markdown -t html %c | w3m -dump -cols 128 -T text/html
filetype  *.md,*.mkd,*.markdown  pandoc -f markdown -t html %c | w3m -dump -cols 128 -T text/html | less, mdp %c

" Log
fileview  *.log  tac %c, tail -n500 %c
filetype  *.log  tac %c | less, multitail %f, lnav %f

" json files
fileview  *.json  jq --color-output '.' %c, python -m json.tool -- %c

" pcap files
filetype  *.pcap,*.cap  sngrep -iI %c

" Object
fileview  *.o  nm %c
filetype  *.o  nm %c | less

" PGP
fileview  *.asc  gpg --quiet --no-tty --no-use-agent --no-verbose -d %c
filetype  *.asc  !!gpg --verify %c

" torrent
fileview  *.torrent  transmission-show %c, dumptorrent -v %c
filetype  *.torrent
          \ FUSE_MOUNT|btfs %SOURCE_FILE %DESTINATION_DIR,
          \ ktorrent %f &,
          \ aria2c %f &

" Misc archive/zip files
fileview  *.a,*.deb,*.alz,*.xz,*.txz,*.tZ,*.tzo  als %c, ouch list %c
filetype  *.a,*.deb,*.alz,*.xz,*.txz,*.tZ,*.tzo  als %c | less

" FuseZipMount
fileview  *.zip,*.jar,*.war,*.ear  als %c, ouch list %c
filetype  *.zip,*.jar,*.war,*.ear
          \ FUSE_MOUNT|fuse-zip %SOURCE_FILE %DESTINATION_DIR,
          \ FUSE_MOUNT|ratarmount %SOURCE_FILE %DESTINATION_DIR,
          \ zip -sf %c | less,
          \ tar -xf %c,
          \ aunpack %c,

" ArchiveMount
fileview  *.tar,*.tgz,*.tar.gz,*.tbz,*.tbz2,*.tar.bz2  als %c, zcat %c
filetype  *.tar,*.tgz,*.tar.gz,*.tbz,*.tbz2,*.tar.bz2
          \ FUSE_MOUNT|archivemount %SOURCE_FILE %DESTINATION_DIR,
          \ aunpack %c,
          \ ouch decompress %c,

" Fuse7z
fileview  *.7z  als %c, 7z l %c, ouch list %c
filetype  *.7z
          \ FUSE_MOUNT|ratarmount %SOURCE_FILE %DESTINATION_DIR,
          \ FUSE_MOUNT|fuse-7z %SOURCE_FILE %DESTINATION_DIR,
          \ 7z x %c,
          \ aunpack %c,
          \ ouch decompress %c,

" Rar2FsMount
fileview  *.rar  unrar v %c, als --option=use_rar_for_unpack=0 %c
filetype  *.rar
          \ FUSE_MOUNT|ratarmount %SOURCE_FILE %DESTINATION_DIR,
          \ FUSE_MOUNT|rar2fs %SOURCE_FILE %DESTINATION_DIR,
          \ unrar x %c,
          \ aunpack %c,
          \ ouch decompress %c,

" IsoMount
fileview  *.iso  isoinfo -l -i %c
filetype  *.iso
          \ FUSE_MOUNT|ratarmount %SOURCE_FILE %DESTINATION_DIR,
          \ FUSE_MOUNT|fuseiso %SOURCE_FILE %DESTINATION_DIR,

" SshMount
filetype  *.ssh
          \ FUSE_MOUNT|ratarmount %SOURCE_FILE %DESTINATION_DIR,
          \ FUSE_MOUNT2|sshfs %PARAM %DESTINATION_DIR %FOREGROUND,

" FtpMount
filetype  *.ftp
          \ FUSE_MOUNT|ratarmount %SOURCE_FILE %DESTINATION_DIR,
          \ FUSE_MOUNT2|curlftpfs -o ftp_port=-,,disable_eprt %PARAM %DESTINATION_DIR %FOREGROUND,

" AppImage
filetype  *.AppImage
          \ FUSE_MOUNT|squashfuse -o offset=$(%SOURCE_FILE --appimage-offset) %SOURCE_FILE %DESTINATION_DIR

" MD5
filetype  *.md5  md5sum -c %c %S

" SHA1
filetype  *.sha1  sha1sum -c %c %S

" SHA256
filetype  *.sha256  sha256sum -c %c %S

" SHA512
filetype  *.sha512  sha512sum -c %c %S

" Windows EXE
fileview  *.exe  echo Windows binary file: no preview available. %i

" Misc
fileview  *.txt,*.desktop
          \ bat -- %c, cat -- %c

" Open all other files with default system programs.
" By default all unknown files are opened with 'vi[x]cmd'
"fileview  *[^/] highlight -O xterm256 --force -s pablo %c
filetype  *  fileopen %c
fileview  *  fileview %c
" }}}

" vim: foldmethod=marker
